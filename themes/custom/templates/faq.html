{% extends "base.html" %}

{% block content %}
<section class="section">
    <div class="container">
        <div class="faq-content">
            {% if page %}
            <h1 class="section-title">{{ page.title }}</h1>
            {% if page.metadata and page.metadata.get('Last_Updated') %}
            <p style="text-align: center; color: var(--soft-gray); margin-bottom: 3rem;">{{ page.metadata.get('Last_Updated') }}</p>
            {% endif %}
            {% endif %}
            
            {% if page and page.content %}
            <div class="faq-list">
                {% set content = page.content %}
                {% set sections = content.split('<h2') %}
                {% set has_items = false %}
                {% for section in sections %}
                    {% if section.strip() and not loop.first %}
                        {% if '>' in section %}
                            {% set tag_parts = section.split('>', 1) %}
                            {% if tag_parts|length > 1 %}
                                {% set content_after_tag = tag_parts[1] %}
                                {% if '</h2>' in content_after_tag %}
                                    {% set qa_parts = content_after_tag.split('</h2>', 1) %}
                                    {% set question_text = qa_parts[0]|trim %}
                                    {% set answer_text = qa_parts[1] if qa_parts|length > 1 else '' %}
                                    
                                    {% if answer_text %}
                                        {% set answer_cleaned = answer_text|trim %}
                                        {% if '<h2' in answer_cleaned %}
                                            {% set answer_cleaned = answer_cleaned.split('<h2')[0]|trim %}
                                        {% endif %}
                                    {% else %}
                                        {% set answer_cleaned = '' %}
                                    {% endif %}
                                    
                                    {% if question_text %}
                                        {% set has_items = true %}
                                    <div class="faq-item">
                                        <div class="faq-question">{{ question_text }}</div>
                                        <div class="faq-answer">
                                            <div class="faq-answer-content">
                                                {{ answer_cleaned|safe }}
                                            </div>
                                        </div>
                                    </div>
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                        {% endif %}
                    {% endif %}
                {% endfor %}
                {% if not has_items %}
                    {# Fallback: if parsing failed, show content as-is but wrapped #}
                    <div class="faq-item">
                        <div class="faq-question">Content</div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                {{ content|safe }}
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
            {% endif %}
            
            <div style="text-align: center; margin-top: 3rem;">
                <p style="color: var(--soft-gray); margin-bottom: 1rem;">{{ _('Your question was not answered?') }}</p>
                <a href="/#contact" class="btn">{{ _('Contact Us') }}</a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

